---
title: "Major factors influencing the physical and mental health of Canadians"
author: 
  - Yuxuan Yang
thanks: "Code and data are available at: https://github.com/Yuxuan-Yang-Maggie/Canadian-Wellbeing."
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "The general wellbeing of Canadians, in terms of both physical and mental health, can greatly reflect the development level of Canada as a country, as well as serving as accurate measures of living conditions of Canadians; yet wellbeing of Canadians differ to a large extent between groups of varying demographic characteristics. In this paper, we used data from “General social survey on Canadians at Work and Home (cycle 30), 2016” to analyze potential factors affecting the wellbeing of Canadians. We found that smoking, drinking, and eating behaviors could all affect people’s health level, while sex, income, and job satisfactions as well as other factors are related to people’s mental stress. As factors influencing Canadian wellbeing are becoming clear, we hope the Canadian government could pay attention to and improve Canadians’ living qualities, especially for minority groups."
output:
  bookdown::pdf_document2
toc: FALSE
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(modelr)
```

# Introduction

Improving the Canadian wellbeing and living standards has always been a main goal of the Canadian government. As stated by Statistics Canada, measures such as the Canadian Index of Well-being (CIW) were designed and put into use in as early as the 2000s in order to provide more accurate measures of Canadian people’s wellbeing, from aspects including health conditions, economic status, and social status (Sanmartin et al., 2021). In the meantime, with the fast-paced development of technology and medical benefits, Canadians are experiencing longer lives and more healthy lifestyles. Nevertheless, contrary to the longer lifespan, the self-rated happiness level of Canadians is deteriorating (2017). In this paper, our goal is to examine which factors would affect Canadian wellbeing and give suggestions to the government to improve both physical and mental health conditions of Canadians, especially those who belong to minority groups. 

Factors such as age, gender, and income are all related to happiness of Canadians; in specific, more than 60% of Canadians with household incomes greater than 80,000 dollars per year reported to be in excellent health conditions, while less than 50% of Canadians with household incomes less than 40,000 dollars per year reported to be in good health. There are also less common variables that have not been widely examined before, including smoking, drinking, and eating behaviors of Canadian people, as well as frequency of doing sports or exercises. 

A survey was created in 2016 to measure both the physical and mental health of Canadians in 10 provinces in Canada aged 15 and above. To facilitate sampling procedure, each of the 10 provinces were divided into strata, and each of the respondent was reached via telephone. Online survey and telephone survey are also used in order to decrease the non-response rate. From the survey responses, age, sex and income are all related to people’s mental health; smoking, drinking, and eating habits are related to physical health. Particularly, people with unhealthy life styles and lower incomes experience worse levels of wellbeing. 

The paper is structured as follows: first, we talk about the survey methodology and sample and population frames. Second, we manipulated collected survey data to analyze potential factors influencing general wellbeing of Canadians. Finally, we give some advice to the government on how to improve the physical and mental health of Canadian people. 


# Data

## Data Collection

The data we used in this paper was retrieved from the Canadian General Social Survey (GSS). The Canadian GSS was designed to be “a series of independent, annual, cross-sectional surveys, each covering one topic in-depth” that collects survey responses from Canadian citizens and permanent residents (cite Canadian GSS website here). It serves a purpose of analyzing the social trends of Canadians’ well-beings from varying aspects. In this paper, we will focus on the “General social survey on Canadians at Work and Home (cycle 30), 2016”, which gathers information on various aspects of Canadians through phone calls and interviews, throughout August to December, 2016. 

Note that we could have used other datasets since many people have conducted relevant researches on factors associated with people’s well-beings. However, the Canadian GSS is a government-lead platform, so we trust in the integrity and authenticity of its information. 

## Data Processing

We conducted all data analysis using the R Programming Language [@citeR]. First, we used the “readxl” [@citereadxl] package to read in the data in excel format. Then we used the “janitor” package [@citejanitor] and “tidyverse” package [@citetidyverse] to perform high-level cleaning and manipulation on the data. In specific, we filtered out all observations with missing responses and NAs and created new variables recording the gender, health level and stress level in categorical formats. We stored the cleaned data as csv file in the inputs sub-folder of our project. We also used the "ggplot2" package [@citeggplot2] to plot graphs and images in Data Results Sections. 

## Survey Method

Stratified sampling method was used in the collection procedure of “General social survey on Canadians at Work and Home (cycle 30), 2016”. In specific, the Canadian government divided the target population (residents) who live in 10 provinces in Canada (Newfoundland and Labrador, Prince Edward Island, Nova Scotia, New Brunswick, Quebec, Ontario, Manitoba, Saskatchewan, Alberta, and British Columbia) in to 27 strata by Metropolitan areas, and randomly sampled respondents from each strata to collect information. Note that regions including Yukon, Northwest Territories, and Nunavut are not included in the survey. 

The data were gathered electronically via computer-assisted telephone interviews (CATI), and all the survey question responses were self-reported by participants. Specifically, the government first sent letters to randomly selected households in each strata to invite them to participate in this survey. Then one member from each household was randomly selected to fill in the specific questions in the questionnaire. There turned out to be 19,609 respondents in this survey. 

### Strengths

The most notable strength of this survey is that it used stratified sampling; dividing the target population into different subgroups and randomly selecting participants from each strata could significantly improve the representativeness of a survey compared to simple random sampling.


### Weaknesses

Since the overall response rate was only approximately 50% after the government invited households to participate, there would be significant non-response bias associated with the results collected by the survey. In order to make up for this weakness, we filtered out all observations with missing values in the variables we are interested in. Nevertheless, this action of filtering out missing values would decrease the total number of usable observations drastically from 19,609 to no more than 2000, which led to another problem of a too small actual sample size in our further analysis. What’s more, the complex nature of stratified sampling procedure would make it difficult to interpret analysis results, compared with simple random sampling directly from the entire population. 


## Data Characteristics

The original raw dataset we extracted from the CHASS data center contains 19,609 observations, yet the cleaned dataset we used in our analysis would only contain 1,586 observations of respondents (Canadian residents) and their demographic information (such as sex, age group, and province of residence), as well as information on their well-beings from different aspects. Using the cleaned dataset, we created Table \@ref(tab:Table1) to take a glimpse and get a sense of what our actual data looks like. From Table \@ref(tab:Table1), we observed the stress level, health level, and alcohol consumption status of 10 respondents. In specific, each row is an individual respondent, and each column represents a specific aspect associated with well-being of a person. 

```{r,echo=FALSE, warning=FALSE, message=FALSE}
# import data here
data_cleaned <- read_csv("/cloud/project/inputs/data/data_cleaned.csv")
```

```{r Table1, echo = FALSE, warning=FALSE}
library(knitr)
table_1 <- data_cleaned[1:10, c(1, 12:15)]
table_1 %>%
  kable(caption = "Glimpse: Canadians and their well-being measured in various aspects in 2016")
```

We also created Table \@ref(tab:Table2) to demonstrate the number and proportion of respondents at each self-rated health level. From Table \@ref(tab:Table2), we observed that the proportion of participants is highest for health level 7-10 (18.9%, 29.4%, 14.4%, and 14.2%), indicating that most people seem to be very satisfied with their health conditions in 2016 on a scale from 0 to 10 (0 is not at all satisfied with health condition, and 10 is completely satisfied). In addition, we created a bar plot to demonstrate the proportions of people by stress level. 


```{r, echo=FALSE, message=FALSE, warning=FALSE}
data_cleaned <- data_cleaned %>%
  mutate(stress = fct_relevel(stress, "A bit stressful", after = 2)) %>%
  mutate(stress = fct_relevel(stress, "Extremely stressful", after = 5)) %>%
  mutate(health = fct_relevel(health, "Not at all satisfied", after = 0)) %>%
  mutate(health = fct_relevel(health, "Completely satisfied", after = 11))

```

```{r Table2, echo=FALSE, message=FALSE, warning=FALSE}

table_2 <- data_cleaned %>%
  group_by(health) %>%
  summarise(count = n(), proportion = n()/1586)

table_2 %>%
  kable(caption = "Number and proportion of respondents by self-rated health level")
```

Figure \@ref(fig:Figure1) plots proportion (y axis) against stress level (x-axis) and shows that almost half of participants reported to be a bit stressful in daily lives, and more than 20 percent of people reported to be not very stressful. Figure \@ref(fig:Figure1) shows that most Canadians experienced appropriate levels of stress in 2016.

```{r Figure1, fig.cap="Proportions of Canadians Who Responded to the Work and Life General Social Survey in 2016, By Stress Level", echo=FALSE, message=FALSE, warning=FALSE}

data_cleaned %>%
  group_by(stress) %>%
  summarise(proportion = n()/1586) %>%
  ggplot(aes(x = stress, y = proportion)) +
  geom_bar(position="dodge", stat="identity") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  labs(title = "Proportion of Respondents By Stress Level",
       x = "Stress Level",
       y = "Proportion of People") +
  theme_minimal()
```

# Model
```{r, echo=FALSE, message=FALSE, warning=FALSE}
data_cleaned <- data_cleaned %>%
  mutate(smoke = case_when(smoke_status == 1 ~ "Daily",
                           smoke_status == 2 ~ "Occasionally",
                           TRUE ~ "Not at all")) %>%
  mutate(drink = case_when(drink_status == 1 ~ "Daily",
                           drink_status == 2 ~ "4-6 times a week",
                           drink_status == 3 ~ "2-3 times a week",
                           drink_status == 4 ~ "Once a week",
                           drink_status == 5 ~ "Once or twice in the past month",
                           drink_status == 6 ~ "Not in the past month",
                           TRUE ~ "Never had a drink"))


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
data_cleaned <- data_cleaned %>%
  filter(eat_habits != 7) %>%
  mutate(eat = case_when(eat_habits == 1 ~ "Excellent",
                         eat_habits == 2 ~ "Very good",
                         eat_habits == 3 ~ "Good",
                         eat_habits == 4 ~ "Fair",
                         TRUE ~ "Poor"))
```

\begin{equation}
Pr(\theta | y) = \frac{Pr(y | \theta) Pr(\theta)}{Pr(y)}  (\#eq:bayes)
\end{equation} will be useful. 

Equation \@ref(eq:bayes) will be useful.

Here's a dumb example of how to use some references: In paper we run our analysis in `R` (cite R here). We also use the `tidyverse` which was written by ... If we were interested in baseball data then ... could be useful. 

We can use maths by including latex between dollar signs, for instance $\theta$.

Keywords: Here we will build linear regression models, analyze factors influecing Canadian wellbeing. 

# Results

```{r Figure2, fig.cap="Smoking Frequency", echo=FALSE, warning=FALSE, message=FALSE}

# First plot smoking frequency
Name = c("Daily", "Occasionally", "Not at all")

s1 <- sum(data_cleaned$smoke =='Daily') 
s2 <- sum(data_cleaned$smoke =='Occasionally')
s3 <- sum(data_cleaned$smoke =='Not at all')

smokes = c(s1,s2,s3)

colors = c("#990000","#FF3333","#FF9999")

# calculate the percentage
smoke_percentage = paste(round(100*smokes/sum(smokes)), "%")

# draw the pie graph
pie(smokes, labels = smoke_percentage, col = colors, main = "Frequency of Smoking")

legend("topright", Name, cex = 0.6, fill = colors)

```

```{r Figure3, fig.cap="Alcohol Consumption Frequency", echo=FALSE, warning=FALSE, message=FALSE}
# Then plot drinking frequency
name = c("Daily", "4-6 times a week", "2-3 times a week", "Once a week", "Once or twice in the past month", "Not in the past month", "Never had a drink")

d1 <- sum(data_cleaned$drink =='Daily') 
d2 <- sum(data_cleaned$drink =='Occasionally')
d3 <- sum(data_cleaned$drink =='2-3 times a week')
d4 <- sum(data_cleaned$drink =='Once a week')
d5 <- sum(data_cleaned$drink =='Once or twice in the past month')
d6 <- sum(data_cleaned$drink =='Not in the past month')
d7 <- sum(data_cleaned$drink =='Never had a drink')

drinks = c(d1, d2, d3, d4, d5, d6, d7)

cols = c("#193300", "#336600","#4C9900","#66CC00", "#80FF00", "#B2FF66", "#E5FFCC")

# calculate the percentage
drink_percentage = paste(round(100*drinks/sum(drinks)), "%")

# draw the pie graph
pie(drinks, labels = drink_percentage, col = cols, main = "Frequency of Alcohol")

legend("bottomright", name, cex=0.5, fill = cols)

```


From Figure \@ref(fig:Figure2) where we generated a pie chart to show the percentages of respondents with different smoking behaviors, we observed that only around 10% of total respondents smoke daily or occasionally, while most respondents don’t smoke at all. From Figure \@ref(fig:Figure3) where we also drew a pie chart to demonstrate the percentages of people at each level of alcohol consumption, we observed that 27% respondents didn’t drink in the past month and 18% respondents never had the habit of drinking, while almost no respondents (0%) drink every day. Figure \@ref(fig:Figure2) and Figure \@ref(fig:Figure3) together shows that respondents in this survey seems to have healthy, sustainable drinking and smoking habits. 


```{r Figure4, fig.cap="Number of People Under Each Self-Rated Health Level, with Eat Habits Highlighted in Colors", echo=FALSE, message=FALSE, warning=FALSE}
data_cleaned %>%
  ggplot(aes(x = health, 
            fill = factor(eat_habits, levels = c("1","2","3","4","5"),
                          labels = c("Excellent",
                                     "Very good",
                                     "Good",
                                     "Fair",
                                     "Poor")))
       ) +
  geom_bar(position = "stack") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  labs(title = "Distribution of Health Level",
       x = "Self-Rated Health Level",
       y = "Number of People",
       fill = "eat_habits") +
  theme_minimal()

```


Then we drew a bar plot called Figure \@ref(fig:Figure4) to demonstrate the distribution of number of people at different health levels, with eating habits highlighted in different colors at each health level. Figure \@ref(fig:Figure4) shows that the mode of this distribution is more than 400 people at health level 8. Since 0 means not at all satisfied and 10 means completely satisfied on a scale from 0 to 10, we know that most people are quite satisfied with their health conditions. What’s more, people with higher health levels (better self-rated health conditions) tend to have better overall eating habits compared with those with lower health levels (worse health conditions). 

```{r Figure5, fig.cap="Number of People Under Each Self-Rated Stress Level, By Sex", echo=FALSE, message=FALSE, warning=FALSE}
data_cleaned %>%
  group_by(Gender, stress) %>%
  summarise(count = n()) %>%
  ggplot(aes(x = stress, y = count, fill = Gender)) +
  geom_bar(position="dodge", stat="identity") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  labs(title = "Number of Respondents By Sex and Stress Level",
       x = "Self-Rated Stress Level",
       y = "Number of Respondents") +
  theme_minimal()

```

We also drew Figure \@ref(fig:Figure5) to show the distribution of number of people at different stress levels. Figure \@ref(fig:Figure5) shows that for both males and females, the number of respondents is the largest (nearly 400) under the level of “a bit stressful” and the second largest (nearly 200) under the level “not very stressful”. This indicates that most respondents are experiencing appropriate, moderate mental stress regardless of sex. 

```{r Figure6, fig.cap="Number of People Under Each Self-Rated Stress Level, with Job Satisfaction Highlighted", echo=FALSE, message=FALSE, warning=FALSE}
data_cleaned %>%
  ggplot(aes(x = stress, 
             fill = factor(job_satisfaction, levels = c("1","2","3","4","5"),
                          labels = c("Very satisfied",
                                     "Satisfied",
                                     "Neither satisfied nor dissatisfied",
                                     "Dissatisfied",
                                     "Very dissatisfied")))
       ) +
  geom_bar(position = "stack") +
  scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
  labs(title = "Number of People on Each Stress Level",
       x = "Self-Rated Stress Level",
       y = "Number of People",
       fill = "job_satisfaction") +
  theme_minimal()
```

Lastly, we created Figure \@ref(fig:Figure6) to also illustrate the distribution of number of people at different stress levels, but this time with number of people with different job satisfaction levels highlighted in colors at each stress level. Same from Figure \@ref(fig:Figure5), we observed from Figure \@ref(fig:Figure6) that most people experience normal stress conditions. Additionally, we observed that people with lower levels of mental stress tend to be more satisfied with their jobs compared with those with high levels of mental stress, indicating that job satisfaction could be correlated with people’s mental health conditions.  



# Discussion
Keywords: Extend the topic. Talk way more. 

## First discussion point

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what I know and what I learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional details


\newpage


# References


